# Описание АРТ (Адаптивная резонансная теория)

Сеть АРТ представляет собой векторный классификатор. Входной вектор классифицируется в зависимости от того, на какой из множества ранее запомненых образов он похож. Свое классификационное решение сеть АРТ выражает в форме возбуждения одного из нейронов распознающего слоя. Если входной вектор не соответствует ни одному из запомненных образов, создается новая категория посредством запоминания образа, идентичного новому входному вектору. Если определено, что входной вектор похож на один из ранее запомненных векторов с точки зрения определенного критерия сходства, запомненный образ будет изменяться (обучаться) под воздействием нового входного вектора таким образом, чтобы стать более похожим на этот входной вектор.

Запомненный образ не будет изменяться, если текущий входной вектор не окажется достаточно похожим на него. Новый образ может создавать дополнительные классификационные категории, однако новый входной образ не может заставить измениться существующую память.

# Упрощенная архитектура АРТ

Архитектура АРТ представленна в виде четырех функциональных модулей:
1. Слой сравнения (реализация нейрона в файле `comparison`)
2. Слой распознавания (реализация нейрона в файле `recognition`)
3. Приемник 1 (файл `receiver_1`)
3. Сброс (файл `reset_block`)

```
               ________________________________
              |                                |
              |       Слой распознавания       |<----|
              |________________________________|     |
                    |               / \              |
                 R  |                |               |
         __________/ \______         |               | C
        |                   |        |           ____|____
        |                   |        |          |         |
        |                   |        |--------->|  Сброс  |
        |                   |        | C        |_________|
 ______\_/_____          __\_/_______|_____         / \
|              |  G1    |                  |         |
|  Приемник 1  |------->|  Слой сравнения  |         |
|______________|        |__________________|         |
       / \                       / \                 |
        |                         |                  |
        \-------------------------|------------------/
                                  |
                                  X
```

## Слой сравнения

```
                                  R                                  C
              _________________________________________        ____________
             /                                         \      /            \
               | r1               | r2     ...       | rn       c1  c2  cm
              /|\                /|\                /|\         / \ / \ / \
            /  |  \            /  |  \            /  |  \        |   |   |
          /    |    \        /    |    \        /    |    \      |   |   |
        t11   t12   t1m    t21   t22   t2m    tn1   tn2   tnm    |   |...|
         |     |     |      |     |     |      |     |     |     |   |   |
         -------------      -------------      -------------     |   |   |
         |     T1    |      |     T2    |      |     Tn    |     |   |   |
         -------------      -------------      -------------     |   |   |
         |     |     |      |     |     |      |     |     |     |   |   |
         |     |     |______|_____|_____|______|_____|_____|     |   |   |
         |     |____________|_____|____________|_____|     |     |   |   |
         |__________________|_____|____________|           |     |   |   |
         |                        |                        |     |   |   |
         |                        |                        |     |   |   |
   P1 __\_/_                P2 __\_/_                P3 __\_/_   |   |   |
     |      |                 |      |                 |      |  |   |   |
  /->|      |              /->|      |              /->|      |  |   |   |
  |  |______|              |  |______|              |  |______|  |   |   |
  |   / \  |               |   / \  |               |   / \  |   |   |   |
  |____|___|_______________|____|___|_______________|    |   |___|   |   |
       |   |                    |   |____________________|___________|   |
       |   |____________________|________________________|_______________|
       |                        |                        |
       X1                       X2                       Xm
    \________________________________________________________/
                                X
```

Слой сравнения получает двоичный входной вектор `X` и первоначально пропускает его неизменным для формирования выходного вектора `C`. На более поздней фазе в распознающем слое вырабатывается двоичный вектор `R`, модифицирующий вектор `C`, как описано ниже.

Каждый нейрон `comparison` в слое сравнения получает три двоичных входа (0 или 1):
1. Компонента Xi входного вектора `X`
2. Сигнал обратной связи `R` - взвешенная сумма выходов распознающего слоя
3. Вход `G1` от Приемника 1 (один и тот же сигнал подается на все нейроны этого слоя)

Чтобы получить на выходе нейрона `comparison` единичное значение, как минимум два из трех его входов должны равняться единице; в противном случае его выход будет нулевым. Таким образом релизуется правило двух третей.

Первоначально выходной сигнал `G1` Приемника 1 установлен в едининцу, обеспечивая один из необходимых для возбуждения нейронов входов, а все компоненты вектора `R` установлены в 0; следовательно, в этот момент вектор `C` идентичен двоичному входному вектору `X`.

## Слой распознавания

```
 _________________________________________________________________________
 |   ____________________________________________                         |
 |   |   _______________                         |                        |
 |   |   |              |                        |                        |
 |   |   |          ____|____                ____|____                ____|____ 
 |   |   |         |         |              |         |              |         |
 |   |   |         |   OUT   |              |   OUT   |              |   OUT   |
 |   |   |         |    F    |              |    F    |              |    F    |
 |   |   |         |_________|              |_________|              |_________|
 |   |   |             / \                      / \                      / \
 |   |   |              |                        |                        |
 |   |   |              |                        |                        |
 |   |   |              |                        |                        |
 |   |   |          ____|____                ____|____                ____|____ 
 |   |   |         |         |              |         |              |         |
 |   |   |         |   NET   |              |   NET   |              |   NET   |
 |   |   |         |_________|              |_________|              |_________|
 |   |   |         / \ / \ / \              / \ / \ / \              / \ / \ / \
 |   |   |          |   |   |                |   |   |                |   |   |
 |   |   |        -------------            -------------            -------------
 |   |   |      B1 /    |    \           B2 /    |    \           B2 /    |    \
 |   |   |        -------------            -------------            -------------
 |   |   |       /      |      \          /      |      \          /      |      \
 |   |   |  b11 /   b21 |   bm1 \    b12 /   b22 |   bm2 \    b1n /   b2n |   bmn \
 |   |...|     c1      c2      cm       c1      c2      cm       c1      c2      cm
 |   |   |   \_______________________________________________________/
\ / \ / \ /                             |
 r1  r2  rn                            / \
\__________/                            C
   R  |
     \ /
```

Слой распознавания осуществляет классификацию входных векторов. Каждый нейрон `recognition` в слое распознавания имеет соответствующий вектор весов `Bj`. Только один нейрон с весовым вектором, наиболее соответствующим входному вектору, возбуждается; все остальные нейроны заторможены.

Нейрон в распознавающем слое имеет максимальную реакцию, если вектор `C`, являющийся выходом слоя сравнения, соответствует набору его весов, следовательно, веса представляют запомненный образ или экземпляр для категории входных векторов. Эти веса являются действительными числами, а не двоичными величинами. Двоичная версия этого образа также запоминается в соответствующем наборе весов слоя сравнения; этот набор состоит из весов связей, соединяющих определенные нейроны слоя распознавания, один вес на каждый нейрон слоя сравнения.

В процессе функционирования каждый нейрон слоя распознавания вычисляет свертку вектора собственных весов и входного вектора `C`. Нейрон, имеющий веса, наиболее близкие вектору `C`, будет иметь самый большой выход, тем самым выигрывая соревнование и одновременно затормаживая все остальные нейроны в слое.

## Приемник 1

Выходной сигнал `G1` Приемника 1 равен 1, если хотя бы одна компонента двоичного входного вектора `X` равна единице; однако если хотя бы одна компонента вектора `R` равна единице, `G1` устанавливается в нуль. 

## Сброс

Модуль сброса измеряет сходство между векторами `X` и `C`. Если они отличаются сильнее, чем требует параметр сходства, вырабатывается сигнал сброса возбужденного нейрона в слое распознавания.

В процессе функционирования модуль сброса вычисляет сходство как отношение количества единиц в векторе `C` к их количеству в векторе `X`. Если это отношение ниже значения параметра сходства, вырабатывается сигнал сброса.

# Функционирование сети APT в процессе классификации

Процесс классификации в APT состоит из трех основных фаз:
1. Распознавание
2. Сравнение
3. Поиск

## Фаза распознавания

В начальный момент времени входной вектор отсутствует на входе сети; следовательно, все компоненты входного вектора `X` можно рассматривать как нулевые. Тем самым сигнал `G2` устанавливается в 0 и, следовательно, в нуль устанавливаются выходы всех нейронов `recognition` слоя распознавания. Поскольку все нейроны `recognition` слоя распознавания начинают работу в одинаковом состоянии, они имеют раные шансы выиграть в последующей конкуренции.

Затем на вход сети подается входной вектор `X`, который должен быть классифицирован. Этот вектор должен иметь одну или более компонент `xi`, отличных от нуля, в результате чего `G1` становится равным единице. Это "подкачивает" нейроны `comparison` слоя сравнения, обеспечивая один из двух единичных входов, необходимых для возбуждения нейронов в соответствии с правилом двух третей, тем самым позволяя нейрону возбудиться, если соответствующая компонента входного вектора `X` равна единице. Таким образон, в течении данной фазы вектор `C` в точности дублирует вектор `X`.

Далее для каждого нейрона `recognition` в слое распознавания вычисляется свертка вектора его весов `Bj` и вектора `C`: `NET = (Bj * C)`. Нейрон с максивальным значением свертки имеет веса, наилучшим образом соответствующие входному вектору. Он выигрывает конкуренцию и возбуждается, одновременно затормаживая все остальные нейроны этого слоя. Таким образом единственная компонента `ri` вектора `R` становится равной единице, а все остальные компоненты становятся равными нулю.

## Фаза сравнения

Единственный возбужденный в слое распознавания нейрон `recognition` возвращает единицу обратно в слой сравнения в виде своего выходного сигнала `ri`. Эта единственная единица может быть визуально представлена в виде "веерного" выхода, подающегося через отдельную связь `tij` на каждый нейрон `comparison` в слое сравнения, обеспечивая каждый нейрон сигналом `pj` равным величине `tij` (нулю или единице).

Так как вектор `R` не является больше нулевым, сигнал `G1` устанавливается в нуль. Таким образом, в соответствии с правилом двух третей, возбудиться могут только нейроны, получающие на входе одновременно единицы от входного вектора `X` и вектора `P`.

Другими словами, обратная связь от распознабщего слоя действует таким образом, чтобы установить компоненты `C` в нуль в случае, если входной вектор не соответствует входному образу, т.е. если `X` и `P` не имеют совпадающие компоненты.

Если имеются существенные различия между `X` и `P` (малое количество совпадающих компонентов), несколько нейронов на фазе сравнения будут возбуждены и `C` будет содержать много нулей, в то время как `X` содержит единицы. Это означает, что возвращенный вектор `P` не является искомым и возбужденные нейроны `recognition` в слое распознавания должны быть заторможены. Это торможение производится блоком сброса, который сравнивает входной вектор `X` и вектор `C` и вырабатывает сигнал сброса, если степень сходства этих векторов меньше некоторого уровня. Влияние сигнала сброса заключается в установке выхода возбужденного нейрона в нуль, отключая его на время текущей классификации.

## Фаза поиска

Если не выработан сигнал сброса, сходство является адекватным, и процесс классификации завершается. В противном случае другие запомненные образы должны быть исследованы с целью поиска лучшего соответствия. При этом торможение возбужденного нейрона `recognition` в распознающем слое приводит к установке всех компонент вектора `R` в 0, `G1` устанавливается в 1 и входной вектор `X` опять прикладывается в качестве `C`. В результате другой нейрон выигрывает соревнование в слое распознавания и другой запомненный образ `P` возвращается в слой сравнения. Если `P` не соответствует `X`, возбужденный нейрон `recognition` в слое распознавания снова тормозится. Этот процесс продолжается до тех пор, пока не встретится одно из двух событий:

1. Найден запомненный образ, сходство которого с вектором `X` выше уровня параметра сходства, т.е. `S > p`. Если это происходит, проводится обучающий цикл, в процессе которого модифицируются веса векторов `T` и `B`, связанных с возбужденным нейроном `recognition` в слое распознавания.
2. Все запомненные образы проверены, определено, что они не соответствуют входному вектору, и все нейроны `recognition` слоя распознавания заторможены. В этом случае предварительно не распределенный нейрон `recognition` в распознающем слое выделяется этому образу и его весовые векторы `Bj` и `Tj` устанавливаются соответствующими новому входному образу.

# Рклизация APT

## Функционирование сетей APT

Рассмотрим более детально пять фаз процесса функционирования APT: 
1. Инициализацию
2. Распознавание
3. Сравнение
4. Поиск
5. Обучение.

## Инициализация

Перед началом процесса обучения сети все весовые векторы `Bj` и `Tj`, а также параметр сходства `p`, должны быть установлены в начальные значения.

Веса векторов `Bj` все инициализируются в одинаковые малые значения,удовлетворяющие условию:

`bij < L/(L - 1 + m)`

где `m` - количество компонент входного вектора `X`, `L` - константа, большая 1 (обычно `L=2`)

Веса вектором `Tj` все инициализируются в единичные значения, так что:

`tij = 1`

Параметр сходства `p` устанавливается в диапозоне от 0 до 1 в зависимости от требуемой степени сходства между запомненным образом и входным вектором. При высоких значениях `p` сеть относит к одному классу только очень слабо отличающиеся образы. С другой стороны, малое значение `p` заставляет сеть группировать образы, которые имеют слабое сходство между собой. Может оказаться желательной возможность изменять коэффициент сходства на протяжении процесса обучения, обеспечивая только грубую классификацию в начале процесса обучения, и затем постепенно увеличивая коэффициент сходства для выработки точной классификации в конце процесса обучения.

## Распознавание

Появление на входе сети входного вектора `X` инициализирует фазу распознавания. Так как вначале выходной вектор слоя распознавания отсутствует, сигнал `G1` устанавливается в 1 функцией ИЛИ вектора `X`, обеспечивая все нейроны слоя сравнения одним из двух входов, необходимых для их возбуждения (как требует правило двух третей). В результате любая компонента вектора `X`, равная единице, обеспечивает второй единичный вход, тем самым заставляя соответствующий нейрон слоя сравнения возбуждаться и устанавливая его выход в единицу. Таким образом, в этот момент времени вектор С идентичен вектору `X`.

Как обсуждалось ранее, распознавание реализуется вычислением свертки для каждого нейрона слоя распознавания, определяемой следующим выражением:

`NETj = (Bj * C)`

где `Bj` - Как обсуждалось ранее, распознавание реализуется вычислением свертки для каждого нейрона слоя распознавания, определяемой следующим выражением: `С` – выходной вектор нейронов слоя сравнения; в этот момент С равно X; `NETj` – возбуждение нейрона j в слое распознавания.

F является пороговой функцией, определяемой следующим образом:

`OUTj = 1, если NETj > T`
`OUTj = 0 в противном случае`

где `Т` представляет собой порог.

Только нейрон с максимальным значением NET будет иметь выход, равный единице; все остальные нейроны будут иметь нулевой выход.

## Сравнение

На этой фазе сигнал обратной связи от слоя распознавания устанавливает `G1` в нуль; правило двух третей позволяет возбуждаться только тем нейронам, которые имеют равные единице соответствующие компоненты векторов `Р` и `X`.

Блок сброса сравнивает вектор `С` и входной вектор `X`, вырабатывая сигнал сброса, когда их сходство `S` ниже порога сходства. Следующая процедура проводит требуемое вычисление сходства:

1. Вычислить `D` – количество единиц в векторе X.
2. Вычислить `N` – количество единиц в векторе С.

Затем вычислить сходство `S` следующим образом:

`S=N/D`

S может изменяться от 1 (наилучшее соответствие) до 0 (наихудшее соответствие).

Заметим, что правило двух третей делает `С` логическим произведением входного вектора `Х` и вектора `Р`. Однако `Р` равен `Тj`, весовому вектору выигравшего соревнование нейрона. Таким образом, `D` может быть определено как количество единиц в логическом произведении векторов `Тj` и `X`.

## Поиск

Если сходство `S` выигравшего нейрона превышает параметр сходства, поиск не требуется. Однако если сеть предварительно была обучена, появление на входе вектора, не идентичного ни одному из предъявленных ранее, может возбудить в слое распознавания нейрон со сходством ниже требуемого уровня. В соответствии с алгоритмом обучения возможно, что другой нейрон в слое распознавания будет обеспечивать более хорошее соответствие, превышая требуемый уровень сходства несмотря на то, что свертка между его весовым вектором и входным вектором может иметь меньшее значение. Пример такой ситуации показан ниже.

Если сходство ниже требуемого уровня, запомненные образы могут быть просмотрены с целью поиска, наиболее соответствующего входному вектору образа. Если такой образ отсутствует, вводится новый несвязанный нейрон `recognition`, который в дальнейшем будет обучен. Для инициализации поиска сигнал сброса тормозит возбужденный нейрон `recognition` в слое распознавания на время проведения поиска, сигнал `G1` устанавливается в единицу и другой нейрон `recognition` в слое распознавания выигрывает соревнование. Его запомненный образ затем проверяется на сходство и процесс повторяется до тех пор, пока конкуренцию не выиграет нейрон из слоя распознавания со сходством, большим требуемого уровня (успешный поиск), либо пока все связанные нейроны не будут проверены и заторможены (неудачный поиск).

`Неудачный поиск` будет автоматически завершаться на несвязанном нейроне, так как его веса все равны единице, своему начальному значению. Поэтому правило двух третей приведет к идентичности вектора `С` входному вектору `X`, сходство `S` примет значение единицы и критерий сходства будет удовлетворен.

## Обучение

Обучение представляет собой процесс, в котором набор входных векторов подается последовательно на вход сети и веса сети изменяются при этом таким образом, чтобы сходные векторы активизировали соответствующие нейроны. Заметим, что это – неуправляемое обучение, нет учителя и нет целевого вектора, определяющего требуемый ответ.

Пусть вектор весов `Вj` (связанный с возбужденным нейроном j распознающего слоя) равен нормализованной величине вектора `С`. Эти веса вычисляются следующим образом:

`bij = (L * ci)/(L - 1 + sum(ci))`

где `сi` – i-я компонента выходного вектора слоя сравнения; `j` – номер выигравшего нейрона в слое распознавания; `bij` – вес связи, соединяющей нейрон i в слое сравнения с нейроном j в слое распознавания; `L` – константа > 1 (обычно 2).

Компоненты вектора весов `Тj`, связанного с новым запомненным вектором, изменяются таким образом, что они становятся равны соответствующим двоичным величинам вектора С:

`tij = ci`

где `tij` является весом связи между выигравшим нейроном j в слое распознавания и нейроном i в слое сравнения.

